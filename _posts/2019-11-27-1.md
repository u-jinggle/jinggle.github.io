---
published: true
layout: single
title: "Rails Method"
category: post
comments: true
---

#### respond_to
- 메서드로 지정된 형식으로 템플릿이 출력되는 형태
- html, xml, json등의 format을 확인해 보기 위해 사용

#### form_for
- 모델과 연동되는 입력 양식을 생성할때 사용Programming Ruby 1.9’ 루비책의 제목이 들어있는 h3엘리먼트가 있는지 확인
- 입력 값을 모델의 속성으로 변환해줌
- 수정 또는 오류가 발생할 때 모델의 현재 값을 입력 양식에 출력
- 내부적으로 f.label, f.text_field, f.data_select, f.check_box, f.submit 등의 메서드를 가지고 있음
~~~
form_for(model) do |f|
    ...입력 양식...
end
~~~

#### validates()
- 표준 레일스 유효성 검사기, 데이터 검증을 위해 모델단에서 사용됨
- 하나 이상의 모델 필드를 하나 이상의 조건에 맞춰봄
- presence : true -> 유효성 검사기가 각 이름의 필드가 존재하고 값이 비어 있지 않은은지 검사
~~~
validates :title, :description, :image_url, presence: true
~~~
- numericality() : 가격이 숫자인지 검사
~~~
validates :price, numericality: {greater_than_or_equal_to: 0.01} #가격은 0.01보다 작지 않은 수여야 한다.
~~~
- uniqueness : 해당 값이 유일한지 확인
~~~
validates :title, uniqueness: true
~~~
- format :
~~~
validates :image_url, allow_blank: true, format: {
    with: %r{\.{gif|jpg|png)$}i,
    message: '~~'
}
~~~ 

---
### MODEL
#### has_many controller명[, dependent: :destroy]
- 명시한 controller이 테이블에 대해 많은 row를 포함할 수 있음
- [, dependent: :destroy] : 명시된 controller의 테이블행 현재 controller의의 테이블 행에 존재의 의존적임

#### belongs_to : controller명
- 현재 controller의 테이블 행이 명시된 controller 테이블행 자식임을 나타냄행
- 현재 테이블이 외래키를 가지면 해당 되는 모델은 그 각각에 belongs_to를 선언해야

#### find_or_initialize_by (=find_or_initialize_by)
- 파인더가 nil을 리턴하던 곳에서 모델 객체 클래스에 대해 new()나 create()가 호출됨
 
---

### TEST

#### assert
- 단언 : 참이기를 기대하는 것이 무엇인지 프레임워크에 알려주는 메서드
- 참이면 아무일도 일어나지 않지만, 거짓이면 단언이 실패되며 메세지를 출력하고 실패를 포함한 테스트 메서드의 실행을 중

#### assert_select
{% highlight Bash %} 
1. main 영역안에 클래스 이름이 entry인 엘리먼트가 3개인지 확인
ex) assert_select '#main .entry', 3

2. 'Programming Ruby 1.9' 루비책의 제목이 들어있는 h3엘리먼트가 있는지 확인
ex) assert_select 'h3', 'Programming Ruby 1.9'

3. price클래스의 가격 형식이 올바르게 맞춰져 있는지 확인
ex) assert_select '.price', /\$[,\d]+\.\d\d/
{% endhighlight %}

#### 테스트 픽스처
- 테스트를 실행할 수 있는 환경
- 레일스에서는 테스트하는 모델의 초기 데이터에 대한 명세
- CVS or YAML 형식으로 작성
- 모델하나에 대한 데이터를 입력, 데이터베이스 테이블의 이름과 일치

#### assigns
- 스케폴드가 생성하는 메서드
- 뷰에서 사용하기 위해 컨트롤러 액션에서 할당한 인스턴스 변수에 접근가능 하게 해줌
- 사용법 assigns(:인스턴스변수명)

---
### 변수
#### abc : 지역변수
- view에 넘길 필요가 없는 지역변수 명시
#### @abc : 인스턴스 변수
- view에서 사용될 변수

---
### rails
#### rails generater migration add_XXX_to_TABLE 컬럼명:데이터형식
- TABLE에 컬럼명:데이터형식에 해당하는 하나 이상의 칼럼을 추가함

#### rails generater migration add_XXX_from_TABLE 컬럼명:데이터형식
- TABLE에 컬럼명:데이터형식에 해당하는 하나 이상의 칼럼을 추가함


---
### rake
#### rake db:migrate
- db 스키마 생성

#### rake db:rollback
- db 스키마 초기화

#### rake db:seed
- db/seed.rb 파일을 참조해 스키마에 데이터 생성